# ğŸ—ï¸ LECTRA Architecture Diagram

## High-Level Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         END USER                                 â”‚
â”‚                    (No Terminal Needed!)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ Clicks Generate Button
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TAURI DESKTOP APP                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Vue 3 Frontend (TypeScript)                              â”‚  â”‚
â”‚  â”‚  â€¢ Wood-themed UI with glassmorphism                      â”‚  â”‚
â”‚  â”‚  â€¢ NavBar, HeroLogo, GeneratorPanel, etc.                â”‚  â”‚
â”‚  â”‚  â€¢ Form inputs: project, lang, voice, text               â”‚  â”‚
â”‚  â”‚  â€¢ Result display with paths and preview                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â”‚ HTTP POST                         â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Rust Backend (Sidecar Management)                        â”‚  â”‚
â”‚  â”‚  â€¢ Auto-starts Python sidecar on app launch              â”‚  â”‚
â”‚  â”‚  â€¢ Manages sidecar process lifecycle                     â”‚  â”‚
â”‚  â”‚  â€¢ Proxies HTTP requests to port 8765                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ Spawns & Manages
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               PYTHON SIDECAR (lecture-sidecar.exe)               â”‚
â”‚                   FastAPI Server (Port 8765)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  API Routes (api.py)                                      â”‚  â”‚
â”‚  â”‚  â€¢ GET  /healthz        â†’ Health check                   â”‚  â”‚
â”‚  â”‚  â€¢ POST /generate       â†’ Full pipeline                  â”‚  â”‚
â”‚  â”‚  â€¢ POST /estimate       â†’ Timing only                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                    â–¼                   â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Services Layer      â”‚   â”‚  Configuration       â”‚           â”‚
â”‚  â”‚  (Your Code!)        â”‚   â”‚  (config.py)         â”‚           â”‚
â”‚  â”‚                      â”‚   â”‚  â€¢ .env loader       â”‚           â”‚
â”‚  â”‚  â€¢ tagging.py        â”‚   â”‚  â€¢ Path management   â”‚           â”‚
â”‚  â”‚  â€¢ tag_to_ssml.py    â”‚   â”‚  â€¢ Voice WPM map     â”‚           â”‚
â”‚  â”‚  â€¢ tts_engine.py     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”‚  â€¢ timing.py         â”‚                                       â”‚
â”‚  â”‚  â€¢ postgres.py       â”‚                                       â”‚
â”‚  â”‚  â€¢ ollama_client.py  â”‚                                       â”‚
â”‚  â”‚  â€¢ ppt_sync.py       â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                          â”‚
            â”‚                          â”‚
            â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   OLLAMA (Local)    â”‚    â”‚  EdgeTTS (Cloud)    â”‚
â”‚   llama3.1:latest   â”‚    â”‚  Microsoft API      â”‚
â”‚   Port 11434        â”‚    â”‚  Free, No Auth      â”‚
â”‚                     â”‚    â”‚                     â”‚
â”‚  Generates nuance   â”‚    â”‚  Synthesizes audio  â”‚
â”‚  tags from text     â”‚    â”‚  from text+SSML     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Generate Audio Request

```
1. USER ACTION
   â””â”€> Clicks "Generate Audio" button
       â”œâ”€ Project: "ml-intro"
       â”œâ”€ Language: English
       â”œâ”€ Voice: en-US-GuyNeural
       â””â”€ Text: (uses EN_SAMPLE)

2. FRONTEND (Vue)
   â””â”€> Constructs POST /generate request
       {
         "project": "ml-intro",
         "lang": "en",
         "voice": "en-US-GuyNeural",
         "use_sample": "en",
         "fallback_rate": "-10%",
         "fallback_pitch": "+0st"
       }

3. RUST BACKEND (Tauri)
   â””â”€> Validates sidecar is running
       â””â”€> Forwards request to http://127.0.0.1:8765/generate

4. PYTHON SIDECAR (FastAPI)
   â””â”€> api.py receives request
       â”‚
       â”œâ”€> Step 1: Load text
       â”‚   â””â”€ samples.py â†’ EN_SAMPLE (600 words)
       â”‚
       â”œâ”€> Step 2: Generate tags
       â”‚   â”œâ”€ tagging.py â†’ generate_nuanced_text()
       â”‚   â”‚   â””â”€ ollama_client.py â†’ POST to Ollama
       â”‚   â”‚       â””â”€ OLLAMA: Adds [rate=Â±##%], [pitch=Â±#st], [pause=###ms]
       â”‚   â””â”€ Saves to: ~/Lectures/ml-intro/tagged.txt
       â”‚
       â”œâ”€> Step 3: Convert to SSML
       â”‚   â”œâ”€ tag_to_ssml.py â†’ to_ssml()
       â”‚   â””â”€ Saves to: ~/Lectures/ml-intro/ssml.xml
       â”‚
       â”œâ”€> Step 4: Parse to segments
       â”‚   â””â”€ tag_to_ssml.py â†’ parse_to_segments()
       â”‚       â””â”€ Returns: [{text, voice, rate, pitch, pause_after}, ...]
       â”‚
       â”œâ”€> Step 5: Generate audio
       â”‚   â””â”€ tts_engine.py â†’ speak_edge()
       â”‚       â”œâ”€ For each segment:
       â”‚       â”‚   â”œâ”€ Call EdgeTTS API with prosody
       â”‚       â”‚   â”œâ”€ Generate temp segment MP3
       â”‚       â”‚   â””â”€ Add pause_after silence
       â”‚       â”œâ”€ Concatenate all segments (pydub)
       â”‚       â””â”€ Export to: ~/Lectures/ml-intro/audio.mp3
       â”‚
       â”œâ”€> Step 6: Estimate timing
       â”‚   â””â”€ timing.py â†’ estimate_timings()
       â”‚       â”œâ”€ For each sentence:
       â”‚       â”‚   â”œâ”€ Count words
       â”‚       â”‚   â”œâ”€ Calculate eff_WPM from rate tags
       â”‚       â”‚   â”œâ”€ Add punctuation pauses
       â”‚       â”‚   â”œâ”€ Add tag pauses
       â”‚       â”‚   â””â”€ Compute start/end times
       â”‚       â”œâ”€ Save to: ~/Lectures/ml-intro/timings.json
       â”‚       â””â”€ Save to: ~/Lectures/ml-intro/subs.vtt
       â”‚
       â””â”€> Step 7: Log to database (optional)
           â””â”€ postgres.py â†’ log_job()
               â””â”€ INSERT INTO jobs (lang, voice, duration, path, status)

5. RESPONSE
   â””â”€> FastAPI returns JSON:
       {
         "status": "ok",
         "project_dir": "C:\\Users\\...\\Lectures\\ml-intro",
         "tagged_preview": "[rate=-30%] Machine learning...",
         "mp3_path": ".../audio.mp3",
         "timings_path": ".../timings.json",
         "duration_sec": 127.45,
         "sentence_count": 26
       }

6. FRONTEND (Vue)
   â””â”€> Displays success card with:
       â”œâ”€ Green glassmorphism banner
       â”œâ”€ Duration: 127.45s
       â”œâ”€ Sentence count: 26
       â”œâ”€ Output paths (clickable)
       â””â”€ Play button
```

---

## Component Interaction Matrix

| Component | Depends On | Used By | Purpose |
|-----------|------------|---------|---------|
| **Vue UI** | Tauri API | End User | Form inputs, result display |
| **Rust (Tauri)** | Python sidecar | Vue UI | Process management, HTTP proxy |
| **FastAPI** | Services, Config | Rust | Route handling, orchestration |
| **tagging.py** | ollama_client.py | FastAPI | LLM wrapper |
| **ollama_client.py** | Ollama HTTP | tagging.py | Streaming LLM calls |
| **tag_to_ssml.py** | - | FastAPI, timing.py | Tag parsing, SSML conversion |
| **tts_engine.py** | EdgeTTS, pydub | FastAPI | Audio synthesis |
| **timing.py** | tag_to_ssml.py | FastAPI | Deterministic duration calc |
| **postgres.py** | psycopg | FastAPI | Job logging (optional) |
| **config.py** | python-dotenv | All services | Environment, paths, defaults |

---

## File System Layout

```
~/Lectures/
â””â”€â”€ <project-name>/
    â”œâ”€â”€ tagged.txt      â† Text with [rate=X%] [pitch=Xst] [pause=Xms]
    â”œâ”€â”€ ssml.xml        â† Azure SSML markup (reference only)
    â”œâ”€â”€ audio.mp3       â† Generated speech (128kbps, concatenated)
    â”œâ”€â”€ timings.json    â† Per-sentence timing data
    â””â”€â”€ subs.vtt        â† WebVTT subtitles

C:\edgettstest\LECTRA\
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ lecture-sidecar.exe   â† Bundled Python + FastAPI
â”œâ”€â”€ sidecar/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api.py
â”‚   â”‚   â”œâ”€â”€ config.py
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â”œâ”€â”€ nuance_system_prompt.txt
â”‚   â”‚       â”œâ”€â”€ ollama_client.py
â”‚   â”‚       â”œâ”€â”€ tagging.py
â”‚   â”‚       â”œâ”€â”€ tag_to_ssml.py
â”‚   â”‚       â”œâ”€â”€ tts_engine.py
â”‚   â”‚       â”œâ”€â”€ timing.py
â”‚   â”‚       â”œâ”€â”€ postgres.py
â”‚   â”‚       â”œâ”€â”€ ppt_sync.py
â”‚   â”‚       â””â”€â”€ samples.py
â”‚   â””â”€â”€ requirements.txt
â””â”€â”€ ui/
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ App.vue
    â”‚   â”œâ”€â”€ main.ts
    â”‚   â”œâ”€â”€ styles.css
    â”‚   â”œâ”€â”€ assets/images/
    â”‚   â”‚   â”œâ”€â”€ darkest_wood.png
    â”‚   â”‚   â”œâ”€â”€ dark_wood.png
    â”‚   â”‚   â”œâ”€â”€ light_wood.png
    â”‚   â”‚   â””â”€â”€ title.png
    â”‚   â””â”€â”€ components/
    â”‚       â”œâ”€â”€ NavBar.vue
    â”‚       â”œâ”€â”€ HeroLogo.vue
    â”‚       â”œâ”€â”€ FeatureCards.vue
    â”‚       â”œâ”€â”€ TechStack.vue
    â”‚       â”œâ”€â”€ GeneratorPanel.vue
    â”‚       â”œâ”€â”€ ProgressBar.vue
    â”‚       â””â”€â”€ FooterMadeWithLove.vue
    â””â”€â”€ src-tauri/
        â””â”€â”€ src/
            â””â”€â”€ main.rs       â† Sidecar launcher
```

---

## Network Topology

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Tauri Window   â”‚
â”‚  127.0.0.1:5173  â”‚ â† Vite Dev Server (Dev Mode)
â”‚                  â”‚ â† Embedded Files (Production)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ HTTP Fetch
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Python Sidecar   â”‚
â”‚  127.0.0.1:8765  â”‚ â† FastAPI (Uvicorn)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚             â”‚
         â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ollama     â”‚  â”‚   EdgeTTS    â”‚
â”‚ localhost:   â”‚  â”‚ HTTP API     â”‚
â”‚    11434     â”‚  â”‚ (Internet)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ports Used**:
- `5173` - Vite dev server (dev mode only)
- `8765` - Python FastAPI sidecar (always)
- `11434` - Ollama LLM server (always)
- `443` - EdgeTTS HTTPS (cloud, always)

---

## Error Handling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Action: Generate Audio                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Ollama Reachable?    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚              â”‚
          NO             YES
           â”‚              â”‚
           â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  503     â”‚   â”‚ Continue â”‚
    â”‚  Error   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚  Toast:  â”‚         â”‚
    â”‚ "Start   â”‚         â–¼
    â”‚  Ollama" â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ EdgeTTS Reachable?   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚              â”‚
                    NO             YES
                     â”‚              â”‚
                     â–¼              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  502     â”‚   â”‚ Success  â”‚
              â”‚  Error   â”‚   â”‚  Return  â”‚
              â”‚  Toast:  â”‚   â”‚  Result  â”‚
              â”‚ "Check   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ Internet"â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Build Process Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Development Files                      â”‚
â”‚  â€¢ Python source (.py)                  â”‚
â”‚  â€¢ Vue components (.vue)                â”‚
â”‚  â€¢ TypeScript (.ts)                     â”‚
â”‚  â€¢ Rust source (.rs)                    â”‚
â”‚  â€¢ CSS/Tailwind                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚
        â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PyInstaller  â”‚    â”‚ Vite Build   â”‚
â”‚              â”‚    â”‚              â”‚
â”‚ â€¢ Bundles    â”‚    â”‚ â€¢ Compiles   â”‚
â”‚   Python     â”‚    â”‚   Vueâ†’JS     â”‚
â”‚ â€¢ Embeds     â”‚    â”‚ â€¢ Bundles    â”‚
â”‚   resources  â”‚    â”‚   assets     â”‚
â”‚ â€¢ Creates    â”‚    â”‚ â€¢ Optimizes  â”‚
â”‚   .exe       â”‚    â”‚   CSS        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚
        â”‚                   â–¼
        â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚ Tauri Build  â”‚
        â”‚           â”‚              â”‚
        â”‚           â”‚ â€¢ Compiles   â”‚
        â”‚           â”‚   Rust       â”‚
        â”‚           â”‚ â€¢ Bundles    â”‚
        â”‚           â”‚   Vite dist  â”‚
        â”‚           â”‚ â€¢ Creates    â”‚
        â”‚           â”‚   native app â”‚
        â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Distribution Package                   â”‚
â”‚  â€¢ LECTRA_1.0.0_x64-setup.exe (Windows) â”‚
â”‚  â€¢ Contains:                            â”‚
â”‚    - Tauri native window                â”‚
â”‚    - Embedded Vue app                   â”‚
â”‚    - lecture-sidecar.exe (bundled)      â”‚
â”‚    - Icons, assets                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Timing Calculation Details

```
INPUT: Tagged sentence
[rate=-20%] Machine learning is a subset of AI [pause=700ms].
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Parse Tags                      â”‚
â”‚  â€¢ rate = -20%                          â”‚
â”‚  â€¢ pause = 700ms                        â”‚
â”‚  â€¢ text = "Machine learning is..."     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Count Words                     â”‚
â”‚  â€¢ words = 7                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Get Base WPM                    â”‚
â”‚  â€¢ lang = "en"                          â”‚
â”‚  â€¢ voice = "en-US-GuyNeural"            â”‚
â”‚  â€¢ base_wpm = 160 (from config)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Calculate Effective WPM         â”‚
â”‚  â€¢ eff_wpm = 160 * (1 + (-20/100))     â”‚
â”‚  â€¢ eff_wpm = 160 * 0.8 = 128           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: Spoken Duration                 â”‚
â”‚  â€¢ spoken_sec = (7 / 128) * 60         â”‚
â”‚  â€¢ spoken_sec = 3.28 seconds           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 6: Punctuation Pauses              â”‚
â”‚  â€¢ period = 1 * 450ms = 450ms          â”‚
â”‚  â€¢ punct_ms = 450ms                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 7: Tag Pauses                      â”‚
â”‚  â€¢ tag_pause = 700ms (from [pause=])   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 8: Total Duration                  â”‚
â”‚  â€¢ total = 3.28 + (450 + 700)/1000     â”‚
â”‚  â€¢ total = 3.28 + 1.15 = 4.43 sec      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
OUTPUT: {start: 0.0, end: 4.43, duration: 4.43}
```

---

## Technology Stack Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRESENTATION LAYER                    â”‚
â”‚  â€¢ Vue 3 (Composition API)                              â”‚
â”‚  â€¢ Tailwind CSS (Utility-first)                         â”‚
â”‚  â€¢ Custom wood theme + glassmorphism                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APPLICATION LAYER                     â”‚
â”‚  â€¢ Tauri (Rust desktop framework)                       â”‚
â”‚  â€¢ Sidecar process management                           â”‚
â”‚  â€¢ IPC/HTTP communication                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BUSINESS LOGIC                       â”‚
â”‚  â€¢ FastAPI (async Python web framework)                 â”‚
â”‚  â€¢ Orchestration: tagging â†’ SSML â†’ TTS â†’ timing        â”‚
â”‚  â€¢ Error handling & validation                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SERVICE LAYER                       â”‚
â”‚  â€¢ ollama_client (LLM streaming)                        â”‚
â”‚  â€¢ tts_engine (EdgeTTS + pydub)                         â”‚
â”‚  â€¢ timing (deterministic calculation)                   â”‚
â”‚  â€¢ tag_to_ssml (parsing & conversion)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   INTEGRATION LAYER                      â”‚
â”‚  â€¢ Ollama HTTP API (llama3.1:latest)                    â”‚
â”‚  â€¢ EdgeTTS Cloud API (speech synthesis)                 â”‚
â”‚  â€¢ PostgreSQL (optional logging)                        â”‚
â”‚  â€¢ File System (output persistence)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**This architecture ensures**:
âœ… Separation of concerns (UI â†” Business Logic â†” Services)  
âœ… Your existing code preserved as library functions  
âœ… Easy testing (services can be unit tested independently)  
âœ… Scalability (swap Ollama for OpenAI, EdgeTTS for another provider)  
âœ… No terminal dependency (all in-app)

---

Made with â¤ï¸ by GitHub Copilot for Team Just-Git-Gud
